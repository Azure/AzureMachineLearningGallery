amlModuleIdentifier:
  namespace: css
  moduleName: Score Dimensionality Reduction
  description: Score Dimensionality reduction 
  moduleVersion: 0.0.1
description: >
  Apply Dimensionality reduction  to score data using transformation state from training dataset.
isdeterministic: true
metadata:
  annotations:
    tags:
    - Unsupervised Learning
    - Matrix Decomposition
    - Statistics
    sourceCode: https://github.com/azure/amlmodules
    contact: Yassine khelifi <yassinek@microsoft.com>
inputs:
- name: Scoring dataset
  type: DataFrameDirectory
  port: true
- name: Transformation state
  type: ModelDirectory
  port: true

outputs:
- name: Output principal components
  type: DataFrameDirectory
  port: true
implementation:
  container:
    conda: pca_conda.yaml
    image: mcr.microsoft.com/azureml/base-gpu:intelmpi2018.3-cuda10.0-cudnn7-ubuntu16.04
    additionalIncludes: 
      - ../score_pca.py
      - ../pca_module.py
    command: [python, score_pca.py] 
    args: [
        --input-dir, {inputPath: Scoring dataset},
        --model-input-dir, {inputPath: Transformation state},
        --output-dir, {outputPath: Output principal components}
    ]
