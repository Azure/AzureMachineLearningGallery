amlModuleIdentifier:
  namespace: css
  moduleName: Sequence Embeddings
  description: Sequence graph transform.
  moduleVersion: 0.0.1
description: >
  Sequence embedding module  is based on Sequence graph transfom which extracts short and long-term sequence features
  and embeds them in a finite-dimensional feature space.
  https://arxiv.org/abs/1608.03533
isdeterministric: true
metadata:
  annotations:
    tags:
    - Feature Engineering
    - Sequence Analysis
    - Clustering
    - Classification
    sourceCode: https://github.com/azure/amlmodules
    contact: Yassine khelifi <yassinek@microsoft.com>
inputs:
- name: Training dataset
  type: DataFrameDirectory
  port: true
- name: Sequence column
  type: String
- name: Delimiter
  type: String
  optional: true
- name: Length sensitive
  type: Boolean
  default: false
- name: Kappa
  type: Integer
  default: 1
outputs:
- name: Embeddings
  type: DataFrameDirectory
  port: true
- name: Transformation state
  type: ModelDirectory
  port: true
implementation:
  container:
    conda: sgt_conda.yaml
    image: mcr.microsoft.com/azureml/base-gpu:intelmpi2018.3-cuda10.0-cudnn7-ubuntu16.04
    additionalIncludes: 
      - ../train_sgt.py
    command: [python, train_sgt.py] 
    args: [
        --input-dir, {inputPath: Training dataset},
        --output-dir, {outputPath: Embeddings},
        --model-output-dir, {outputPath: Transformation state},
        --sequence-column, {inputValue: Sequence column},
        --delimiter, {inputValue: Delimiter},
        --length-sensitive, {inputValue: Length sensitive},
        --kappa, {inputValue: Kappa} 
    ]
