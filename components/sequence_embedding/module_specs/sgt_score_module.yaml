amlModuleIdentifier:
  namespace: css
  moduleName: Score Sequence Embeddings
  description: Score Sequence mbeddings using Sequence graph transform
  moduleVersion: 0.0.1
description: >
  Apply sequence embeddings to score data using transformation state from training dataset  
  https://arxiv.org/abs/1608.03533.
isdeterministic: true
metadata:
  annotations:
    tags:
    - Feature Engineering
    - Sequence Analysis
    - Clustering
    - Classification
    sourceCode: https://github.com/azure/amlmodules
    contact: Yassine khelifi <yassinek@microsoft.com>
inputs:
- name: Scoring dataset
  type: DataFrameDirectory
  port: true
- name: Transformation state
  type: ModelDirectory
  port: true
- name: Sequence column
  type: String
- name: Delimiter
  type: String
  optional: true
outputs:
- name: Embeddings
  type: DataFrameDirectory
  port: true
implementation:
  container:
    conda: sgt_conda.yaml
    image: mcr.microsoft.com/azureml/base-gpu:intelmpi2018.3-cuda10.0-cudnn7-ubuntu16.04
    additionalIncludes: 
      - ../score_sgt.py
    command: [python, score_sgt.py] 
    args: [
        --input-dir, {inputPath: Scoring dataset},
        --sequence-column, {inputValue: Sequence column},
        --delimiter, {inputValue: Delimiter},
        --model-input-dir, {inputPath: Transformation state},
        --output-dir, {outputPath: Embeddings}
    ]
